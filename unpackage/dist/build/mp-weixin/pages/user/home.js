"use strict";const e=require("../../common/vendor.js"),a=require("../../utils/index.js"),o=require("../../api/apis/user.js");if(!Array){(e.resolveComponent("viiew")+e.resolveComponent("u-image")+e.resolveComponent("vie")+e.resolveComponent("tabbar"))()}Math||((()=>"../../uni_modules/uview-plus/components/u-image/u-image.js")+(()=>"../../components/tabbar/tabbar.js"))();const r={__name:"home",setup(r){const s=e.ref({userAvatar:"",userName:"",province:"",sex:""}),t=()=>{console.log("当前登录已经失效重新登录"),a.getLoginFn().then((a=>{const{userProfilePhoto:o,userNickname:r}=e.index.getStorageSync("userInfo");s.value.userAvatar=o,s.value.userName=r}))},u=async()=>{const a=(await o.editUserInfo({userProfilePhoto:s.value.userAvatar,userNickname:s.value.userName})).data;if(0==a.code){showToast("修改成功");let a=e.index.getStorageSync("userInfo");a={...a,userProfilePhoto:s.value.userAvatar,userNickname:s.value.userName},e.index.setStorageSync("userInfo",a)}else(a.error="10101")&&t()},n=e=>{const{avatarUrl:a=""}=e.detail;a&&(s.value.userAvatar=e.detail.avatarUrl,u())},i=e=>{console.log("nickName",e),e.detail.value&&(s.value.userName=e.detail.value,u())};return e.onLoad((()=>{const{userProfilePhoto:a,userNickname:o}=e.index.getStorageSync("userInfo");s.value.userAvatar=a,s.value.userName=o,console.log(s.value)})),(a,o)=>({a:e.o(n),b:e.p({"open-type":"chooseAvatar",showLoading:!0,src:s.value.userAvatar,width:"80px",height:"80px",shape:"circle"}),c:e.t(s.value.userName||"点击登录"),d:e.o(t),e:e.o(n),f:e.p({"open-type":"chooseAvatar",showLoading:!0,src:s.value.userAvatar,width:"30px",height:"30px",shape:"circle"}),g:e.o(n),h:e.o(i),i:s.value.userName,j:e.o((e=>s.value.userName=e.detail.value))})}};wx.createPage(r);
