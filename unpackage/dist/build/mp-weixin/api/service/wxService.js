"use strict";const e=require("../../common/vendor.js"),t=require("../../utils/index.js"),o=require("../error/errTips.js");let r=e.index.getStorageSync("token");exports.wxService=(s,n,a)=>{let i,c="https://pqartstation.cn/"+s,d={provider:"weixin",...n};return i="POST"==a?{"content-type":"application/x-www-form-urlencoded"}:{"content-type":"application/json"},r&&(i.Authorization=r),new Promise(((r,s)=>{e.index.request({url:c,method:a,header:Object.assign({},i),data:d,dataType:"json",timeout:6e4,success:e=>{const s=e.data;0==s.code?r(s):"10101"==s.error?(t.showToast("token已过期重新登录"),t.getLoginFn().then((e=>{console.log("res",e)}))):t.showToast(o.errTips[s.code]||s.message||"未知错误")},fail:e=>{let o="";switch(e){case 401:o="token 失效，请重新登录",t.getLoginFn().then((e=>{console.log("res",e)}));break;case 403:o="拒绝访问";break;case 404:o="请求地址错误";break;case 500:o="服务器故障";break;default:o="网络连接故障"}t.showToast(o),s(e)},complete:()=>{e.index.hideLoading()}})}))};
