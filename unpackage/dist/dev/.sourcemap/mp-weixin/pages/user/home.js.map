{"version":3,"file":"home.js","sources":["pages/user/home.vue","pages/user/home.vue?type=page"],"sourcesContent":["<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\tcomputed\r\n\t} from \"vue\";\r\n\timport {\r\n\t\tonLoad\r\n\t} from \"@dcloudio/uni-app\";\r\n\timport dayjs from \"dayjs\";\r\n\timport {\r\n\t\tgetSetting,\r\n\t\tgetLoginFn\r\n\t} from \"@/utils/index.js\";\n\t\r\n\timport { editUserInfo } from \"@/api/apis/user\";\n\t\r\n\tconst formData = ref({\r\n\t\tuserAvatar: \"\",\r\n\t\tuserName: \"\",\r\n\t\tprovince: \"\",\r\n\t\tsex: \"\",\r\n\t});\r\n\r\n\tconst editUser = () => {\r\n\t\tuni.navigateTo({\r\n\t\t\turl: \"editUserInfo\",\r\n\t\t});\r\n\t};\r\n\r\n\tconst login = () => {\r\n\t\tconsole.log(\"当前登录已经失效重新登录\");\r\n\t\t// #ifdef MP-WEIXIN\r\n\t\tgetLoginFn().then((data) => {\n\t\t\tdebugger\n\t\t\tconst {\n\t\t\t\tuserProfilePhoto,\n\t\t\t\tuserNickname\n\t\t\t} =\n\t\t\tuni.getStorageSync(\"userInfo\");\n\t\t\tformData.value.userAvatar = userProfilePhoto;\n\t\t\tformData.value.userName = userNickname;\n\t\t});\r\n\t\t// #endif\r\n\t};\n\t\n\tconst editUserInfoFn = async() => {\n\t\tlet data = await editUserInfo({\n\t\t\tuserProfilePhoto : formData.value.userAvatar,\n\t\t\tuserNickname: formData.value.userName\n\t\t})\n\t\tconst res = data.data\n\t\tif (res.code == 0) {\n\t\t\tshowToast('修改成功');\n\t\t\tlet result = uni.getStorageSync(\"userInfo\");\n\t\t\tresult = {\n\t\t\t\t...result,\n\t\t\t\tuserProfilePhoto : formData.value.userAvatar,\n\t\t\t\tuserNickname: formData.value.userName\n\t\t\t}\n\t\t\tuni.setStorageSync(\"userInfo\",result);\n\t\t} else if(res.error = \"10101\") {\n\t\t\tlogin()\n\t\t}\n\t};\n\t\r\n\tconst getUserProfile = (e) => {\n\t\tconst { avatarUrl = \"\"} = e.detail\n\t\tif(avatarUrl) {\n\t\t\tformData.value.userAvatar = e.detail.avatarUrl\n\t\t\teditUserInfoFn();\n\t\t}\n\t}\n\t\n\tconst bindinput = (e) =>{\n\t\t console.log('nickName', e)\n\t\t if(e.detail.value) {\n\t\t\t formData.value.userName = e.detail.value;\n\t\t\t editUserInfoFn();\n\t\t }\n\t }\n\t \r\n\tonLoad(() => {\r\n\t\tconst {\r\n\t\t\tuserProfilePhoto,\r\n\t\t\tuserNickname\r\n\t\t} =\r\n\t\tuni.getStorageSync(\"userInfo\");\r\n\t\tformData.value.userAvatar = userProfilePhoto;\r\n\t\tformData.value.userName = userNickname;\r\n\t\tconsole.log(formData.value);\r\n\t});\n\t\r\n</script>\r\n\r\n<template>\r\n\t<view class=\"content\">\n\t\t<view class=\"content-heard\">\n\t\t\t<viiew class=\"content-heard-back\">\n\t\t\t\t<!-- <u-image :showLoading=\"true\" src=\"\" width=\"100vw\" height=\"250px\"></u-image> -->\n\t\t\t</viiew>\n\t\t\t<view class=\"content-heard-userAvatar\" @click=\"login\">\n\t\t\t\t<u-image open-type=\"chooseAvatar\" @click=\"getUserProfile\" :showLoading=\"true\" :src=\"formData.userAvatar\" width=\"80px\" height=\"80px\"\n\t\t\t\t\tshape=\"circle\"></u-image>\n\t\t\t\t<view class=\"user-name\">\n\t\t\t\t{{ formData.userName || \"点击登录\" }}\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<view class=\"content-main-center\">\n\t\t\t<vie class=\"content-main-center-form\">\n\t\t\t\t<view class=\"content-main-center-form-item\">\n\t\t\t\t\t<view> 头像</view>\n\t\t\t\t\t<view>\n\t\t\t\t\t\t<button style=\"width: 60px;\"  open-type=\"chooseAvatar\" @chooseavatar=\"getUserProfile\">\n\t\t\t\t\t\t\t<u-image open-type=\"chooseAvatar\" @click=\"getUserProfile\" :showLoading=\"true\" :src=\"formData.userAvatar\" width=\"30px\" height=\"30px\"\n\t\t\t\t\t\t\t\tshape=\"circle\"></u-image>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"content-main-center-form-item\">\n\t\t\t\t\t<view> 名称</view>\n\t\t\t\t\t<view style=\"width: calc(100% - 70px);\">\n\t\t\t\t\t\t<input type=\"nickname\" style=\"text-align: right;\" v-model=\"formData.userName\" border=\"none\"  placeholder=\"请输入昵称\"\n\t\t\t\t\t\t@blur=\"bindinput\"></input>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</vie>\n\t\t</view>\n\t\t\n\t\t<tabbar></tabbar>\r\n\t</view>\r\n</template>\r\n\r\n<style lang=\"less\">\r\n\t.content {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\n\t\twidth: 100vw;\r\n\t\theight: 100vh;\r\n\t\tflex-wrap: nowrap;\r\n\t\tbackground: linear-gradient(to bottom, #82b9ff, #ddeafb, #dfe8f3);\r\n\t\t.content-heard {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\talign-content: center;\r\n\t\t\tflex-direction: column;\n\t\t\theight: 220px;\n\t\t\twidth: 100vw;\n\t\t\t.content-heard-back {\n\t\t\t\twidth: 100vw;\n\t\t\t\theight: 220px;\n\t\t\t\tposition: relative;\n\t\t\t}\n\t\t\t.content-heard-userAvatar {\n\t\t\t\tdisplay: flex;\n\t\t\t\tjustify-content: center;\n\t\t\t\tflex-direction: column;\n\t\t\t\talign-items: center;\n\t\t\t\twidth: 100%;\n\t\t\t\t// position: relative;\n\t\t\t\t// background: linear-gradient(#ffffff00 5%,#ffffffa6 25%, #ffffff 50%, #ffffff 100%);\n\t\t\t\t.user-name {\n\t\t\t\t\tmargin-top: 10px;\n\t\t\t\t\tfont-size: 20px;\n\t\t\t\t\tfont-weight: 600;\n\t\t\t\t\tcolor: rgb(28, 28, 28);\n\t\t\t\t}\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.content-main-center {\n\t\t\tflex: 1;\n\t\t\twidth: calc(100vw - 40px);\n\t\t\tborder-radius: 6px;\n\t\t\tbackground: #ffffff;\n\t\t\tmargin: 10px;\n\t\t\tpadding: 10px;\n\t\t\t.content-main-center-form {\n\t\t\t\twidth: calc(100vw - 40px);\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-direction: column;\n\t\t\t\t.content-main-center-form-item {\n\t\t\t\t\t// width: 100%;\n\t\t\t\t\theight: 45px;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tflex-direction: row;\n\t\t\t\t\tjustify-content: space-between;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tpadding: 10px;\n\t\t\t\t}\n\t\t\t}\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from '/Users/pq/code/ph/pages/user/home.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","getLoginFn","editUserInfo","onLoad","MiniProgramPage"],"mappings":";;;;;;;;;;;;;;;;;;;AAgBC,UAAM,WAAWA,cAAAA,IAAI;AAAA,MACpB,YAAY;AAAA,MACZ,UAAU;AAAA,MACV,UAAU;AAAA,MACV,KAAK;AAAA,IACP,CAAE;AAQD,UAAM,QAAQ,MAAM;AACnBC,oBAAAA,MAAY,MAAA,OAAA,6BAAA,cAAc;AAE1BC,6BAAY,EAAC,KAAK,CAAC,SAAS;AAC3B;AACA,cAAM;AAAA,UACL;AAAA,UACA;AAAA,QACA,IACDD,oBAAI,eAAe,UAAU;AAC7B,iBAAS,MAAM,aAAa;AAC5B,iBAAS,MAAM,WAAW;AAAA,MAC7B,CAAG;AAAA,IAEH;AAEC,UAAM,iBAAiB,YAAW;AACjC,UAAI,OAAO,MAAME,2BAAa;AAAA,QAC7B,kBAAmB,SAAS,MAAM;AAAA,QAClC,cAAc,SAAS,MAAM;AAAA,MAChC,CAAG;AACD,YAAM,MAAM,KAAK;AACjB,UAAI,IAAI,QAAQ,GAAG;AAClB,kBAAU,MAAM;AAChB,YAAI,SAASF,cAAAA,MAAI,eAAe,UAAU;AAC1C,iBAAS;AAAA,UACR,GAAG;AAAA,UACH,kBAAmB,SAAS,MAAM;AAAA,UAClC,cAAc,SAAS,MAAM;AAAA,QAC7B;AACDA,sBAAAA,MAAI,eAAe,YAAW,MAAM;AAAA,MACvC,WAAY,IAAI,QAAQ,SAAS;AAC9B,cAAO;AAAA,MACP;AAAA,IACH;AAEC,UAAM,iBAAiB,CAAC,MAAM;AAC7B,YAAM,EAAE,YAAY,GAAE,IAAI,EAAE;AAC5B,UAAG,WAAW;AACb,iBAAS,MAAM,aAAa,EAAE,OAAO;AACrC;MACA;AAAA,IACD;AAED,UAAM,YAAY,CAAC,MAAK;AACtBA,oBAAAA,MAAA,MAAA,OAAA,6BAAY,YAAY,CAAC;AACzB,UAAG,EAAE,OAAO,OAAO;AAClB,iBAAS,MAAM,WAAW,EAAE,OAAO;AACnC;MACA;AAAA,IACD;AAEFG,kBAAAA,OAAO,MAAM;AACZ,YAAM;AAAA,QACL;AAAA,QACA;AAAA,MACA,IACDH,oBAAI,eAAe,UAAU;AAC7B,eAAS,MAAM,aAAa;AAC5B,eAAS,MAAM,WAAW;AAC1BA,oBAAY,MAAA,MAAA,OAAA,6BAAA,SAAS,KAAK;AAAA,IAC5B,CAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzFF,GAAG,WAAWI,SAAe;"}