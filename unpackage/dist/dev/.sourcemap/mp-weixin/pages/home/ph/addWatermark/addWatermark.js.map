{"version":3,"file":"addWatermark.js","sources":["pages/home/ph/addWatermark/addWatermark.vue","pages/home/ph/addWatermark/addWatermark.vue?type=page"],"sourcesContent":["<script setup>\r\n\timport {\r\n\t\tnextTick,\r\n\t\tonMounted,\r\n\t\tref,\r\n\t\treactive,\r\n\t\twatch,\r\n\t\tcomputed\r\n\t} from \"vue\";\r\n\timport {\r\n\t\tonLoad,\r\n\t\tonPullDownRefresh,\r\n\t\tonShow\r\n\t} from \"@dcloudio/uni-app\";\r\n\timport dayjs from \"dayjs\";\r\n\timport imageCropper from \"@/pages/home/components/imageCropper/imageCropper.vue\";\r\n\timport page from \"@/components/pages/page.vue\";\r\n\timport {\r\n\t\tgetCurrentInstance\r\n\t} from \"vue\";\r\n\tconst instance = getCurrentInstance();\r\n\r\n\tconst imageurl = ref({\r\n\t\turl: '',\r\n\t\tstatus: \"success\",\r\n\t\tmessage: 0,\r\n\t})\r\n\tconst formData = ref({\r\n\t\ttest: '',\r\n\t\timage: '',\r\n\t\topacity: '',\r\n\t\tangle: -45, // 角度\r\n\t\tdensity: '' // 密度\r\n\t})\r\n\tconst previewMain = ref({\r\n\t\twidth: '',\r\n\t\theight: ''\r\n\t})\r\n\r\n\t// 清空画布\r\n\tconst clearCanvas = () => {\r\n\t\tconst ctx = uni.createCanvasContext(\"watermark\");\r\n\t\tctx.clearRect(0, 0, previewMain.value.width, previewMain.value.height); // 清空整个画布\r\n\t\tctx.draw();\r\n\t};\r\n\r\n\tonLoad(() => {\r\n\t\tediteImage.value = true\r\n\t\tnextTick(() => {\r\n\t\t\tediteImage.value = false\r\n\t\t})\r\n\t})\r\n\r\n\tonMounted(() => {\r\n\t\t// 创建查询对象\r\n\t\tconst query = uni.createSelectorQuery().in(instance.proxy);\r\n\r\n\t\t// 选择元素\r\n\t\tquery\r\n\t\t\t.select(\"#contentMain\")\r\n\t\t\t.boundingClientRect((data) => {\r\n\t\t\t\tif (data) {\r\n\t\t\t\t\t// data包含元素的宽高等信息\r\n\t\t\t\t\tconsole.log(\"元素的宽：\" + data.width);\r\n\t\t\t\t\tconsole.log(\"元素的高：\" + data.height);\r\n\t\t\t\t\tpreviewMain.value = {\r\n\t\t\t\t\t\twidth: data.width,\r\n\t\t\t\t\t\theight: data.height,\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.exec(); // 执行查询\r\n\t});\r\n\r\n\tconst previewImage = (urls) => {\r\n\t\tuni.previewImage({\r\n\t\t\turls: [urls],\r\n\t\t\tcurrent: 1,\r\n\t\t\tlongPressActions: {\r\n\t\t\t\titemList: [\"发送给朋友\", \"保存图片\", \"收藏\"],\r\n\t\t\t\tsuccess: function(data) {},\r\n\t\t\t\tfail: function(err) {\r\n\t\t\t\t\tconsole.log(err.errMsg);\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '预览失败',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t});\r\n\t}\r\n\tconst getImageInfo = (src) => {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tuni.getImageInfo({\r\n\t\t\t\tsrc,\r\n\t\t\t\tsuccess: resolve,\r\n\t\t\t\tfail: reject\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\r\n\tconst chooseImage = () => {\r\n\t\tuni.chooseImage({\r\n\t\t\tcount: 1,\r\n\t\t\tsizeType: [\"original\", \"compressed\"],\r\n\t\t\tsourceType: [\"album\"],\r\n\t\t\tsuccess: async function(res) {\r\n\t\t\t\tclearCanvas() // 重新绘制\r\n\t\t\t\tconst width = previewMain.value.width;\r\n\t\t\t\tconst height = previewMain.value.height;\r\n\t\t\t\tconst proportion = width / height;\r\n\r\n\t\t\t\t// 获取图片宽高做裁切\r\n\t\t\t\tconst imageInfo = await getImageInfo(res.tempFilePaths[0]);\r\n\r\n\t\t\t\tlet imageW = imageInfo.width;\r\n\t\t\t\tlet imageH = imageInfo.height;\r\n\r\n\t\t\t\t// 计算缩放比例，确保图片在保持宽高比的前提下，缩放到画布的最大尺寸\r\n\t\t\t\tlet scale = 1;\r\n\r\n\t\t\t\tif (imageW > imageH) {\r\n\t\t\t\t\t// 图片宽度大于高度，按高度缩放\r\n\t\t\t\t\tscale = imageW / width;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 图片高度大于宽度，按宽度缩放\r\n\t\t\t\t\tscale = imageH / height;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 缩放后的图片宽度和高度\r\n\t\t\t\timageW /= scale;\r\n\t\t\t\timageH /= scale;\r\n\r\n\t\t\t\t// 计算绘制位置，确保图片在 Canvas 中居中显示\r\n\t\t\t\tlet drawX = (width - imageW) / 2;\r\n\t\t\t\tlet drawY = (height - imageH) / 2;\r\n\r\n\t\t\t\t// 绘制图片到 Canvas\r\n\t\t\t\tconst ctx = uni.createCanvasContext(\"watermark\");\r\n\t\t\t\t// 禁用图像平滑处理以保持清晰度\r\n\t\t\t\tctx.imageSmoothingEnabled = false;\r\n\t\t\t\tawait ctx.drawImage(imageInfo.path, drawX, drawY, imageW, imageH);\r\n\t\t\t\tawait ctx.draw(true);\r\n\t\t\t\t// const cropImage = (await uni.canvasToTempFilePath({ canvasId: \"watermark\" })).tempFilePath;\r\n\r\n\t\t\t\timageurl.value = {\r\n\t\t\t\t\turl: imageInfo.path,\r\n\t\t\t\t\twidth: imageW,\r\n\t\t\t\t\theight: imageH,\r\n\t\t\t\t\tx: drawX,\r\n\t\t\t\t\ty: drawY,\r\n\t\t\t\t\tstatus: \"success\",\r\n\t\t\t\t\tmessage: 0,\r\n\t\t\t\t};\r\n\t\t\t\tediteImage.value = false\r\n\t\t\t},\r\n\t\t\tfail: function(err) {\r\n\t\t\t\tconsole.log(err.errMsg);\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '选择图片失败',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t});\r\n\t}\r\n\r\n\tconst addWatermark = async () => {\r\n\t\tconst imageWidth = imageurl.value.width || 100;\r\n\t\tconst imageHeight = imageurl.value.height || 100;\r\n\t\tconst imageX = imageurl.value.x || 0;\r\n\t\tconst imageY = imageurl.value.y || 0;\r\n\t\tconst ctx = uni.createCanvasContext('watermark'); // 创建canvas上下文\r\n\t\tclearCanvas() // 重新绘制\r\n\t\tawait ctx.drawImage(imageurl.value.url, imageX, imageY, imageWidth, imageHeight);\r\n\t\tconsole.log('imageInfo', imageurl.value.url, imageX, imageY, imageWidth, imageHeight)\r\n\t\tif (formData.value.text) {\r\n\t\t\tlet fontSize = formData.value.fontSize || 20;\r\n\r\n\t\t\t// 创建上下文\r\n\t\t\t// 计算旋转角度（弧度）\r\n\t\t\tconst angle = formData.value.angle * Math.PI / 180;\r\n\t\t\t// 设置填充文本样式\r\n\t\t\tctx.textAlign = 'center';\r\n\t\t\tctx.font = `${fontSize}px Arial`;\r\n\t\t\tctx.fillStyle = `rgba(50, 50, 50, ${formData.value.opacity ||0.3})`;\r\n\r\n\t\t\t// 循环绘制多个水印\r\n\t\t\tfor (let i = 0; i < 15; i++) {\r\n\t\t\t\t// 保存当前画布状态\r\n\t\t\t\tctx.save();\r\n\r\n\t\t\t\t// 计算水印的x和y坐标，这里简单地将水印分散在画布上\r\n\t\t\t\tconst x = (i % 5) * (imageWidth / 2); // 每行5个水印\r\n\t\t\t\tconst y = Math.floor(i / 5) * (imageHeight / 2); // 每列2个水印，根据行数计算y坐标\r\n\r\n\t\t\t\t// 移动到水印的起始位置\r\n\t\t\t\tctx.translate(x + imageWidth / 2, y + imageHeight / 2);\r\n\r\n\t\t\t\t// 旋转画布\r\n\t\t\t\tctx.rotate(angle);\r\n\r\n\t\t\t\t// 绘制水印文本\r\n\t\t\t\tctx.fillText(formData.value.text, 0, 0);\r\n\r\n\t\t\t\t// 恢复画布状态以重置变换\r\n\t\t\t\tctx.restore();\r\n\r\n\t\t\t\t// 恢复平移和旋转状态，准备绘制下一个水印\r\n\t\t\t\t// ctx.resetTransform(); // 重置当前变换矩阵为单位矩阵，并重置当前变换原点\r\n\t\t\t}\r\n\r\n\t\t\t// 恢复画布状态\r\n\t\t\tctx.restore();\r\n\t\t\t// // 设置字体样式和大小\r\n\t\t\t// ctx.setFontSize(fontSize);\r\n\t\t\t// ctx.setFillStyle('rgba(255, 255, 255, 0.5)'); // 半透明白色字体\r\n\r\n\t\t\t// // 计算水印文本的位置\r\n\t\t\t// const textWidth = ctx.measureText(formData.value.text).width;\r\n\t\t\t// const x = (imageWidth - textWidth) / 2;\r\n\t\t\t// const y = imageHeight - fontSize - 10; // 距离底部10px\r\n\t\t\t// console.log(imageWidth, imageHeight, textWidth, x, y)\r\n\t\t\t// 绘制水印文本\r\n\t\t} else {\r\n\t\t\tctx.drawImage(formData.value.image.url, 0, 0, 10, formData.value.image.height * formData.value.image\r\n\t\t\t\t.width / 10);\r\n\t\t}\r\n\t\tctx.draw(true, () => {})\r\n\t}\r\n\r\n\tconst editeImage = ref(false)\r\n\tconst iamgeColumns = reactive([\r\n\t\t[{\r\n\t\t\t\tlabel: \"添加图片/编辑图片\",\r\n\t\t\t\tvalue: 1,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tlabel: \"预览图片\",\r\n\t\t\t\tvalue: 2,\r\n\t\t\t},\r\n\t\t]\r\n\t])\r\n\tconst editImagePicker = (item) => {\r\n\t\tif (item.value[0].value == 1) {\r\n\t\t\tchooseImage();\r\n\t\t} else {\r\n\t\t\tpreviewImage(imageurl.value.url);\r\n\t\t}\r\n\t}\r\n\t// 生成图片\r\n\tconst generateImages = () => {\r\n\t\t// const ctx = uni.createCanvasContext('watermarkImage'); // 创建canvas上下文\r\n\t\t//  ctx.drawImage(imageurl.value.url);\r\n\t\t//  ctx.draw(true, () => {\r\n\t\t// \t\t// 预览生成的图片\r\n\t\t// \t\tuni.previewImage({\r\n\t\t// \t\t\tcurrent: imageurl.value.url, // 当前显示的图片链接\r\n\t\t// \t\t\turls: [imageurl.value.url], // 需要预览的图片链接列表\r\n\t\t// \t\t\tsuccess: () => {\r\n\t\t// \t\t\t},\r\n\t\t// \t\t\tfail: () => {\r\n\t\t// \t\t\t},\r\n\t\t// \t\t});\r\n\t\t//  })\r\n\t\tuni.canvasToTempFilePath({\r\n\t\t\tcanvasId: \"watermark\",\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tconst tempFilePath = res.tempFilePath;\r\n\t\t\t\t// 预览生成的图片\r\n\t\t\t\tuni.previewImage({\r\n\t\t\t\t\tcurrent: tempFilePath, // 当前显示的图片链接\r\n\t\t\t\t\turls: [tempFilePath], // 需要预览的图片链接列表\r\n\t\t\t\t\tsuccess: () => {},\r\n\t\t\t\t\tfail: () => {},\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tfail: (err) => {\r\n\t\t\t\tconsole.error(\"合并图片失败:\", err);\r\n\t\t\t\t// 提示用户合并图片失败\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: \"合并图片失败\",\r\n\t\t\t\t\ticon: \"none\",\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t});\r\n\t}\r\n\r\n\tconst selsectImageFn = () => {\r\n\t\tif (formData.value.image) {\r\n\t\t\tuni.previewImage({\r\n\t\t\t\turls: [formData.value.image],\r\n\t\t\t\tcurrent: 0,\r\n\t\t\t\tlongPressActions: {\r\n\t\t\t\t\titemList: [\"发送给朋友\", \"保存图片\", \"收藏\"],\r\n\t\t\t\t\tsuccess: function(data) {},\r\n\t\t\t\t\tfail: function(err) {\r\n\t\t\t\t\t\tconsole.log(err.errMsg);\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tuni.chooseImage({\r\n\t\t\t\tcount: 1, //默认9\r\n\t\t\t\tsizeType: [\"original\"], //可以指定是原图还是压缩图，默认二者都有\r\n\t\t\t\tsourceType: [\"album\"], //从相册选择\r\n\t\t\t\tsuccess: async function(res) {\r\n\t\t\t\t\tconst hw = await getImageInfo(res.tempFilePaths[0])\r\n\t\t\t\t\tformData.value.image = {\r\n\t\t\t\t\t\turl: res.tempFilePaths[0],\r\n\t\t\t\t\t\twidth: hw.width,\r\n\t\t\t\t\t\theight: hw.height,\r\n\t\t\t\t\t\tstatus: \"success\",\r\n\t\t\t\t\t}\r\n\t\t\t\t\taddWatermark() // 添加水印\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t// 生成水印\r\n\tconst generateWatermark = (item, image) => {\r\n\r\n\t}\r\n</script>\r\n\r\n<template>\r\n\t<u-picker :show=\"editeImage\" :columns=\"iamgeColumns\" keyName=\"label\" @cancel=\"editeImage = false\"\r\n\t\t@confirm=\"editImagePicker\" :closeOnClickOverlay='true'></u-picker>\r\n\t<page title=\"添加水印\" rButton=\"生成图片\" @rButton=\"generateImages\">\r\n\t\t<view class=\"content\">\r\n\t\t\t<view class=\"content-main\" id='contentMain'>\r\n\t\t\t\t<view class=\"watermark-canvas\" @click=\"editeImage= true\">\r\n\t\t\t\t\t<canvas canvas-id=\"watermark\"\r\n\t\t\t\t\t\t:style=\"{ width: previewMain.width +'px', height: previewMain.height +'px'}\"></canvas>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"watermark-canvas-image\">\r\n\t\t\t\t\t<canvas canvas-id=\"watermarkImage\"\r\n\t\t\t\t\t\t:style=\"{ width: previewMain.width +'px', height: previewMain.height +'px'}\"></canvas>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\r\n\t\t\t<view class=\"controlPanel\">\r\n\t\t\t\t<u-form labelWidth=\"100px\" labelPosition=\"left\" labelAlign=\"left\" :model=\"formData\" ref=\"form1\">\r\n\t\t\t\t\t<u-form-item label=\"水印文字\" prop=\"text\" borderBottom ref=\"text\">\r\n\t\t\t\t\t\t<u-input v-model=\"formData.text\" border=\"none\" @change=\"addWatermark\"></u-input>\r\n\t\t\t\t\t</u-form-item>\r\n\t\t\t\t\t<u-form-item label=\"水印图片\" prop=\"image\" borderBottom ref=\"text\">\r\n\t\t\t\t\t\t<u-image width=\"40\" height=\"40\" :src=\"formData.image\" @click.stop=\"selsectImageFn(item)\">\r\n\t\t\t\t\t\t</u-image>\r\n\t\t\t\t\t</u-form-item>\r\n\t\t\t\t\t<u-form-item label=\"水印透明度\" prop=\"opacity\" borderBottom ref=\"text\">\r\n\t\t\t\t\t\t<view style=\"display: flex;align-items: center;\">\r\n\t\t\t\t\t\t\t<view style=\"width: 83%\">\r\n\t\t\t\t\t\t\t\t<u-slider v-model=\"formData.opacity\" @changing=\"(e)=> formData.opacity = e\" min=\"1\"\r\n\t\t\t\t\t\t\t\t\tmax=\"100\"></u-slider>\r\n\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t{{`${formData.opacity} %`}}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</u-form-item>\r\n\t\t\t\t\t<u-form-item label=\"水印旋转\" prop=\"angle\" borderBottom ref=\"text\">\r\n\t\t\t\t\t\t<view style=\"display: flex;align-items: center;\">\r\n\t\t\t\t\t\t\t<view style=\"width: 83%\">\r\n\t\t\t\t\t\t\t\t<u-slider v-model=\"formData.angle\" @changing=\"(e)=> formData.angle = e\" min=\"1\"\r\n\t\t\t\t\t\t\t\t\tmax=\"100\"></u-slider>\r\n\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t{{`${formData.angle} C`}}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</u-form-item>\r\n\t\t\t\t\t<u-form-item label=\"水印密度\" prop=\"density\" borderBottom ref=\"text\">\r\n\t\t\t\t\t\t<view style=\"display: flex;align-items: center;\">\r\n\t\t\t\t\t\t\t<view style=\"width: 83%\">\r\n\t\t\t\t\t\t\t\t<u-slider v-model=\"formData.density\" @changing=\"(e)=> formData.density = e\" min=\"1\"\r\n\t\t\t\t\t\t\t\t\tmax=\"100\"></u-slider>\r\n\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t{{`${formData.density} %`}}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</u-form-item>\r\n\t\t\t\t</u-form>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</page>\r\n\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n\t.content {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tpadding: 10px;\r\n\t\theight: calc(100vh - 20px);\r\n\t\tbackground: #e8e8e8;\r\n\r\n\t\t.content-main {\r\n\t\t\tposition: relative;\r\n\t\t\twidth: calc(100vw - 20px);\r\n\t\t\theight: calc(100vw - 20px);\r\n\t\t\tborder-radius: 6px;\r\n\t\t\tbackground: #ffffff;\r\n\r\n\t\t\t.watermark-canvas {\r\n\t\t\t\tz-index: 200;\r\n\t\t\t\topacity: 1;\r\n\t\t\t}\r\n\r\n\t\t\t.watermark-canvas-image {\r\n\t\t\t\tpointer-events: none;\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\ttop: 0;\r\n\t\t\t\tz-index: 100;\r\n\t\t\t\topacity: 0;\r\n\t\t\t}\r\n\r\n\t\t\t.watermark-container {\r\n\t\t\t\tpointer-events: none;\r\n\t\t\t\twidth: calc(100vw - 40px);\r\n\t\t\t\theight: calc(100vw - 40px);\r\n\t\t\t\tpadding: 10px;\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\ttop: 0px;\r\n\t\t\t\tfont-size: 25px;\r\n\t\t\t\tcolor: rgba(0, 0, 0, 0.2);\r\n\t\t\t\toverflow: hidden;\r\n\r\n\t\t\t\t.watermark {\r\n\t\t\t\t\twhite-space: nowrap;\r\n\t\t\t\t\tmargin: 0 auto;\r\n\t\t\t\t\ttransform: translate(-50%, -50%) rotate(-30deg);\r\n\t\t\t\t\t/* 居中并旋转 */\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.iamge {\r\n\t\t\t\twidth: calc(100vw - 40px);\r\n\t\t\t\theight: calc(100vw - 40px);\r\n\t\t\t\tpadding: 10px;\r\n\t\t\t}\r\n\r\n\t\t\t.preview-main-bottom {\r\n\t\t\t\tz-index: 100;\r\n\t\t\t\tpointer-events: none;\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\ttop: 0px;\r\n\t\t\t\twidth: calc(100vw - 20px);\r\n\t\t\t\theight: calc(100vw - 20px);\r\n\t\t\t\tdisplay: node;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t.controlPanel {\r\n\t\t\tmargin-top: 10px;\r\n\t\t\twidth: calc(100vw - 40px);\r\n\t\t\tpadding: 10px;\r\n\t\t\toverflow-y: auto;\r\n\t\t\tborder-radius: 6px;\r\n\t\t\tbackground: #ffffff;\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from '/Users/pq/code/ph/pages/home/ph/addWatermark/addWatermark.vue'\nwx.createPage(MiniProgramPage)"],"names":["getCurrentInstance","ref","uni","onLoad","nextTick","onMounted","reactive"],"mappings":";;;;;;;;;;;;;;;;;;;;AAgBC,MAAM,OAAO,MAAW;;;;AAIxB,UAAM,WAAWA,cAAAA;AAEjB,UAAM,WAAWC,cAAAA,IAAI;AAAA,MACpB,KAAK;AAAA,MACL,QAAQ;AAAA,MACR,SAAS;AAAA,IACX,CAAE;AACD,UAAM,WAAWA,cAAAA,IAAI;AAAA,MACpB,MAAM;AAAA,MACN,OAAO;AAAA,MACP,SAAS;AAAA,MACT,OAAO;AAAA;AAAA,MACP,SAAS;AAAA;AAAA,IACX,CAAE;AACD,UAAM,cAAcA,cAAAA,IAAI;AAAA,MACvB,OAAO;AAAA,MACP,QAAQ;AAAA,IACV,CAAE;AAGD,UAAM,cAAc,MAAM;AACzB,YAAM,MAAMC,cAAAA,MAAI,oBAAoB,WAAW;AAC/C,UAAI,UAAU,GAAG,GAAG,YAAY,MAAM,OAAO,YAAY,MAAM,MAAM;AACrE,UAAI,KAAI;AAAA,IACV;AAECC,kBAAAA,OAAO,MAAM;AACZ,iBAAW,QAAQ;AACnBC,oBAAAA,WAAS,MAAM;AACd,mBAAW,QAAQ;AAAA,MACtB,CAAG;AAAA,IACH,CAAE;AAEDC,kBAAAA,UAAU,MAAM;AAEf,YAAM,QAAQH,cAAAA,MAAI,oBAAmB,EAAG,GAAG,SAAS,KAAK;AAGzD,YACE,OAAO,cAAc,EACrB,mBAAmB,CAAC,SAAS;AAC7B,YAAI,MAAM;AAETA,wBAAA,MAAA,MAAA,OAAA,qDAAY,UAAU,KAAK,KAAK;AAChCA,wBAAY,MAAA,MAAA,OAAA,qDAAA,UAAU,KAAK,MAAM;AACjC,sBAAY,QAAQ;AAAA,YACnB,OAAO,KAAK;AAAA,YACZ,QAAQ,KAAK;AAAA,UACnB;AAAA,QACK;AAAA,MACL,CAAI,EACA;IACJ,CAAE;AAED,UAAM,eAAe,CAAC,SAAS;AAC9BA,oBAAAA,MAAI,aAAa;AAAA,QAChB,MAAM,CAAC,IAAI;AAAA,QACX,SAAS;AAAA,QACT,kBAAkB;AAAA,UACjB,UAAU,CAAC,SAAS,QAAQ,IAAI;AAAA,UAChC,SAAS,SAAS,MAAM;AAAA,UAAE;AAAA,UAC1B,MAAM,SAAS,KAAK;AACnBA,0BAAA,MAAA,MAAA,OAAA,qDAAY,IAAI,MAAM;AACtBA,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO;AAAA,cACP,MAAM;AAAA,YACZ,CAAM;AAAA,UACD;AAAA,QACD;AAAA,MACJ,CAAG;AAAA,IACD;AACD,UAAM,eAAe,CAAC,QAAQ;AAC7B,aAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACvCA,sBAAAA,MAAI,aAAa;AAAA,UAChB;AAAA,UACA,SAAS;AAAA,UACT,MAAM;AAAA,QACV,CAAI;AAAA,MACJ,CAAG;AAAA,IACH;AAEC,UAAM,cAAc,MAAM;AACzBA,oBAAAA,MAAI,YAAY;AAAA,QACf,OAAO;AAAA,QACP,UAAU,CAAC,YAAY,YAAY;AAAA,QACnC,YAAY,CAAC,OAAO;AAAA,QACpB,SAAS,eAAe,KAAK;AAC5B,sBAAa;AACb,gBAAM,QAAQ,YAAY,MAAM;AAChC,gBAAM,SAAS,YAAY,MAAM;AAIjC,gBAAM,YAAY,MAAM,aAAa,IAAI,cAAc,CAAC,CAAC;AAEzD,cAAI,SAAS,UAAU;AACvB,cAAI,SAAS,UAAU;AAGvB,cAAI,QAAQ;AAEZ,cAAI,SAAS,QAAQ;AAEpB,oBAAQ,SAAS;AAAA,UACtB,OAAW;AAEN,oBAAQ,SAAS;AAAA,UACjB;AAGD,oBAAU;AACV,oBAAU;AAGV,cAAI,SAAS,QAAQ,UAAU;AAC/B,cAAI,SAAS,SAAS,UAAU;AAGhC,gBAAM,MAAMA,cAAAA,MAAI,oBAAoB,WAAW;AAE/C,cAAI,wBAAwB;AAC5B,gBAAM,IAAI,UAAU,UAAU,MAAM,OAAO,OAAO,QAAQ,MAAM;AAChE,gBAAM,IAAI,KAAK,IAAI;AAGnB,mBAAS,QAAQ;AAAA,YAChB,KAAK,UAAU;AAAA,YACf,OAAO;AAAA,YACP,QAAQ;AAAA,YACR,GAAG;AAAA,YACH,GAAG;AAAA,YACH,QAAQ;AAAA,YACR,SAAS;AAAA,UACd;AACI,qBAAW,QAAQ;AAAA,QACnB;AAAA,QACD,MAAM,SAAS,KAAK;AACnBA,wBAAY,MAAA,MAAA,OAAA,sDAAA,IAAI,MAAM;AACtBA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,MAAM;AAAA,UACX,CAAK;AAAA,QACD;AAAA,MACJ,CAAG;AAAA,IACD;AAED,UAAM,eAAe,YAAY;AAChC,YAAM,aAAa,SAAS,MAAM,SAAS;AAC3C,YAAM,cAAc,SAAS,MAAM,UAAU;AAC7C,YAAM,SAAS,SAAS,MAAM,KAAK;AACnC,YAAM,SAAS,SAAS,MAAM,KAAK;AACnC,YAAM,MAAMA,cAAAA,MAAI,oBAAoB,WAAW;AAC/C,kBAAa;AACb,YAAM,IAAI,UAAU,SAAS,MAAM,KAAK,QAAQ,QAAQ,YAAY,WAAW;AAC/EA,oBAAAA,MAAA,MAAA,OAAA,sDAAY,aAAa,SAAS,MAAM,KAAK,QAAQ,QAAQ,YAAY,WAAW;AACpF,UAAI,SAAS,MAAM,MAAM;AACxB,YAAI,WAAW,SAAS,MAAM,YAAY;AAI1C,cAAM,QAAQ,SAAS,MAAM,QAAQ,KAAK,KAAK;AAE/C,YAAI,YAAY;AAChB,YAAI,OAAO,GAAG,QAAQ;AACtB,YAAI,YAAY,oBAAoB,SAAS,MAAM,WAAU,GAAG;AAGhE,iBAAS,IAAI,GAAG,IAAI,IAAI,KAAK;AAE5B,cAAI,KAAI;AAGR,gBAAM,IAAK,IAAI,KAAM,aAAa;AAClC,gBAAM,IAAI,KAAK,MAAM,IAAI,CAAC,KAAK,cAAc;AAG7C,cAAI,UAAU,IAAI,aAAa,GAAG,IAAI,cAAc,CAAC;AAGrD,cAAI,OAAO,KAAK;AAGhB,cAAI,SAAS,SAAS,MAAM,MAAM,GAAG,CAAC;AAGtC,cAAI,QAAO;AAAA,QAIX;AAGD,YAAI,QAAO;AAAA,MAWd,OAAS;AACN,YAAI,UAAU,SAAS,MAAM,MAAM,KAAK,GAAG,GAAG,IAAI,SAAS,MAAM,MAAM,SAAS,SAAS,MAAM,MAC7F,QAAQ,EAAE;AAAA,MACZ;AACD,UAAI,KAAK,MAAM,MAAM;AAAA,OAAE;AAAA,IACvB;AAED,UAAM,aAAaD,cAAG,IAAC,KAAK;AAC5B,UAAM,eAAeK,cAAAA,SAAS;AAAA,MAC7B;AAAA,QAAC;AAAA,UACC,OAAO;AAAA,UACP,OAAO;AAAA,QACP;AAAA,QACD;AAAA,UACC,OAAO;AAAA,UACP,OAAO;AAAA,QACP;AAAA,MACD;AAAA,IACH,CAAE;AACD,UAAM,kBAAkB,CAAC,SAAS;AACjC,UAAI,KAAK,MAAM,CAAC,EAAE,SAAS,GAAG;AAC7B;MACH,OAAS;AACN,qBAAa,SAAS,MAAM,GAAG;AAAA,MAC/B;AAAA,IACD;AAED,UAAM,iBAAiB,MAAM;AAc5BJ,oBAAAA,MAAI,qBAAqB;AAAA,QACxB,UAAU;AAAA,QACV,SAAS,CAAC,QAAQ;AACjB,gBAAM,eAAe,IAAI;AAEzBA,wBAAAA,MAAI,aAAa;AAAA,YAChB,SAAS;AAAA;AAAA,YACT,MAAM,CAAC,YAAY;AAAA;AAAA,YACnB,SAAS,MAAM;AAAA,YAAE;AAAA,YACjB,MAAM,MAAM;AAAA,YAAE;AAAA,UACnB,CAAK;AAAA,QACD;AAAA,QACD,MAAM,CAAC,QAAQ;AACdA,wBAAA,MAAA,MAAA,SAAA,sDAAc,WAAW,GAAG;AAE5BA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,MAAM;AAAA,UACX,CAAK;AAAA,QACD;AAAA,MACJ,CAAG;AAAA,IACD;AAED,UAAM,iBAAiB,MAAM;AAC5B,UAAI,SAAS,MAAM,OAAO;AACzBA,sBAAAA,MAAI,aAAa;AAAA,UAChB,MAAM,CAAC,SAAS,MAAM,KAAK;AAAA,UAC3B,SAAS;AAAA,UACT,kBAAkB;AAAA,YACjB,UAAU,CAAC,SAAS,QAAQ,IAAI;AAAA,YAChC,SAAS,SAAS,MAAM;AAAA,YAAE;AAAA,YAC1B,MAAM,SAAS,KAAK;AACnBA,4BAAA,MAAA,MAAA,OAAA,sDAAY,IAAI,MAAM;AAAA,YACtB;AAAA,UACD;AAAA,QACL,CAAI;AAAA,MACJ,OAAS;AACNA,sBAAAA,MAAI,YAAY;AAAA,UACf,OAAO;AAAA;AAAA,UACP,UAAU,CAAC,UAAU;AAAA;AAAA,UACrB,YAAY,CAAC,OAAO;AAAA;AAAA,UACpB,SAAS,eAAe,KAAK;AAC5B,kBAAM,KAAK,MAAM,aAAa,IAAI,cAAc,CAAC,CAAC;AAClD,qBAAS,MAAM,QAAQ;AAAA,cACtB,KAAK,IAAI,cAAc,CAAC;AAAA,cACxB,OAAO,GAAG;AAAA,cACV,QAAQ,GAAG;AAAA,cACX,QAAQ;AAAA,YACR;AACD,yBAAc;AAAA,UACd;AAAA,QACL,CAAI;AAAA,MACD;AAAA,IACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5TF,GAAG,WAAW,eAAe;"}