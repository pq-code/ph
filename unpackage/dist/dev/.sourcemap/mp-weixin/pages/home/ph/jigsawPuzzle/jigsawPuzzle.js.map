{"version":3,"file":"jigsawPuzzle.js","sources":["pages/home/ph/jigsawPuzzle/jigsawPuzzle.vue","pages/home/ph/jigsawPuzzle/jigsawPuzzle.vue?type=page"],"sourcesContent":["<script setup>\r\n\timport {\r\n\t\tnextTick,\r\n\t\tonMounted,\r\n\t\tref,\r\n\t\treactive,\r\n\t\twatch\r\n\t} from \"vue\";\r\n\timport {\r\n\t\tonLoad,\r\n\t\tonPullDownRefresh,\r\n\t\tonShow\r\n\t} from \"@dcloudio/uni-app\";\r\n\timport dayjs from \"dayjs\";\r\n\timport imageCropper from \"@/pages/home/components/imageCropper/imageCropper.vue\";\r\n\timport page from \"@/components/pages/page.vue\";\r\n\timport {\r\n\t\tgetCurrentInstance\r\n} from \"vue\";\r\n\r\n\tconst instance = getCurrentInstance();\r\n\r\n\tconst previewMain = ref({\r\n\t\twidth: 0,\r\n\t\theight: 0\r\n\t}); // 容器\r\n\tconst spacing = ref(5); // 间隔\r\n\tconst cropImage = ref();\r\n\tconst seletIndex = ref(); // 当前下标\r\n\tconst isOpenCropper = ref(false);\r\n\tconst iamgeMainMax = ref(1);\r\n\tconst formData = reactive({\r\n\t\timageTypeText: \"九宫格\",\r\n\t\timageType: 1,\r\n\t\tscale: 1,\r\n\t});\r\n\tconst editeImage = ref(false)\r\n\r\n\tconst fileListBackups = ref([]); // 备份\r\n\tconst fileList = ref([]); // 裁切后\r\n\tonLoad(()=>{\r\n\t\tediteImage.value = true\r\n\t\tshowImageType.value = true\r\n\t\tnextTick(()=>{\r\n\t\t\tshowImageType.value = false\r\n\t\t\tediteImage.value = false\r\n\t\t})\r\n\t})\r\n\tonMounted(() => {\r\n\t\t// 创建查询对象\r\n\t\tconst query = uni.createSelectorQuery().in(instance.proxy);\r\n\r\n\t\t// 选择元素\r\n\t\tquery\r\n\t\t\t.select(\"#contentMain\")\r\n\t\t\t.boundingClientRect((data) => {\r\n\t\t\t\tif (data) {\r\n\t\t\t\t\t// data包含元素的宽高等信息\r\n\t\t\t\t\tconsole.log(\"元素的宽：\" + data.width);\r\n\t\t\t\t\tconsole.log(\"元素的高：\" + data.height);\r\n\t\t\t\t\tpreviewMain.value = {\r\n\t\t\t\t\t\twidth: data.width,\r\n\t\t\t\t\t\theight: data.height,\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tnineSquareGrid();\r\n\t\t\t})\r\n\t\t\t.exec(); // 执行查询\r\n\t});\r\n\r\n\tconst l3r2 = () => {\r\n\t\tconst widthL3R2L = (previewMain.value.width - spacing.value) * 0.3;\r\n\t\tconst heightL3R2L = (previewMain.value.height - spacing.value * 2) / 3;\r\n\t\tconst widthL3R2R = (previewMain.value.width - spacing.value) * 0.7;\r\n\t\tconst heightL3R2R = (previewMain.value.height - spacing.value) / 2;\r\n\r\n\t\tfileListBackups.value = new Array(5).fill({}).map((item, index) => {\r\n\t\t\tif (index < 3) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\twidth: widthL3R2L,\r\n\t\t\t\t\theight: heightL3R2L,\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: index * (heightL3R2L + spacing.value),\r\n\t\t\t\t\turl: \"\",\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\treturn {\r\n\t\t\t\t\twidth: widthL3R2R,\r\n\t\t\t\t\theight: heightL3R2R,\r\n\t\t\t\t\tx: widthL3R2L + spacing.value,\r\n\t\t\t\t\ty: (index - 3) * (heightL3R2R + spacing.value),\r\n\t\t\t\t\turl: \"\",\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tfileList.value = JSON.parse(JSON.stringify(fileListBackups.value));\r\n\t};\r\n\tconst l2r3 = () => {\r\n\t\tconst widthL3R2R = (previewMain.value.width - spacing.value) * 0.3;\r\n\t\tconst heightL3R2R = (previewMain.value.height - spacing.value * 2) / 3;\r\n\t\tconst widthL3R2L = (previewMain.value.width - spacing.value) * 0.7;\r\n\t\tconst heightL3R2L = (previewMain.value.height - spacing.value) / 2;\r\n\r\n\t\tfileListBackups.value = new Array(5).fill({}).map((item, index) => {\r\n\t\t\tif (index < 2) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\twidth: widthL3R2L,\r\n\t\t\t\t\theight: heightL3R2L,\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: index * (heightL3R2L + spacing.value),\r\n\t\t\t\t\turl: \"\",\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\treturn {\r\n\t\t\t\t\twidth: widthL3R2R,\r\n\t\t\t\t\theight: heightL3R2R,\r\n\t\t\t\t\tx: widthL3R2L + spacing.value,\r\n\t\t\t\t\ty: (index - 2) * (heightL3R2R + spacing.value),\r\n\t\t\t\t\turl: \"\",\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tfileList.value = JSON.parse(JSON.stringify(fileListBackups.value));\r\n\t};\r\n\t// 九宫格\r\n\tconst nineSquareGrid = () => {\r\n\t\tconst width = (previewMain.value.width - spacing.value * 2) / 3;\r\n\t\tconst height = (previewMain.value.height - spacing.value * 2) / 3;\r\n\t\t\r\n\t\tlet list = new Array(9).fill({}).map((item, index) => {\r\n\t\t\tlet row = Math.floor(index / 3);\r\n\t\t\tlet col = index % 3;\r\n\t\t\tlet x = col * (width + spacing.value);\r\n\t\t\tlet y = row * (height + spacing.value);\r\n\t\t\treturn {\r\n\t\t\t\twidth,\r\n\t\t\t\theight,\r\n\t\t\t\tx,\r\n\t\t\t\ty,\r\n\t\t\t\turl: fileListBackups.value[index] ? fileListBackups.value[index]?.url : '',\r\n\t\t\t};\r\n\t\t});\r\n\t\t\r\n\t\tfileListBackups.value = JSON.parse(JSON.stringify(list));\r\n\t\tfileList.value = JSON.parse(JSON.stringify(fileListBackups.value));\r\n\t};\r\n\t// 左右对称\r\n\tconst lrSymmetry = () => {\r\n\t\tconst width = (previewMain.value.width - spacing.value) / 2;\r\n\t\tconst height = previewMain.value.height;\r\n\t\tlet list = new Array(2).fill({}).map((item, index) => {\r\n\t\t\tlet col = index % 2;\r\n\t\t\tlet x = col * (width + spacing.value);\r\n\t\t\tlet y = 0\r\n\t\t\treturn {\r\n\t\t\t\twidth,\r\n\t\t\t\theight,\r\n\t\t\t\tx,\r\n\t\t\t\ty,\r\n\t\t\t\turl: fileListBackups.value[index] ? fileListBackups.value[index]?.url : '',\r\n\t\t\t};\r\n\t\t});\r\n\t\tfileListBackups.value = JSON.parse(JSON.stringify(list));\r\n\t\tfileList.value = JSON.parse(JSON.stringify(fileListBackups.value));\r\n\t}\r\n\t\r\n\tconst tbSymmetry = () => {\r\n\t\tconst width = previewMain.value.width;\r\n\t\tconst height = (previewMain.value.height - spacing.value) / 2;\r\n\t\tfileListBackups.value = new Array(2).fill({}).map((item, index) => {\r\n\t\t\tlet col = index % 2;\r\n\t\t\tlet x = 0\r\n\t\t\tlet y = col * (height + spacing.value);\r\n\t\t\treturn {\r\n\t\t\t\twidth,\r\n\t\t\t\theight,\r\n\t\t\t\tx,\r\n\t\t\t\ty,\r\n\t\t\t\turl: \"\",\r\n\t\t\t};\r\n\t\t});\r\n\t\tfileList.value = JSON.parse(JSON.stringify(fileListBackups.value));\r\n\t}\r\n\tconst showImageType = ref();\r\n\tconst columns = reactive([\r\n\t\t[\t{\r\n\t\t\t\tlabel: \"九宫格\",\r\n\t\t\t\tvalue: 1,\r\n\t\t\t\turl: '@/assets/images/jgg.png'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tlabel: \"九宫格(中间放大)\",\r\n\t\t\t\tvalue: 2,\r\n\t\t\t\turl: '@/assets/images/jgg.png'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tlabel: \"左右对称\",\r\n\t\t\t\tvalue: 3,\r\n\t\t\t\turl: '@/assets/images/lr.png'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tlabel: \"上下对称\",\r\n\t\t\t\tvalue: 4,\r\n\t\t\t\turl: ''\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tlabel: \"左三右二\",\r\n\t\t\t\tvalue: 5,\r\n\t\t\t\turl: ''\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tlabel: \"左二右三\",\r\n\t\t\t\tvalue: 6,\r\n\t\t\t\turl: ''\r\n\t\t\t},\r\n\t\t],\r\n\t]);\r\n\r\n\tconst iamgeColumns = reactive([\r\n\t\t[\t{\r\n\t\t\t\tlabel: \"添加图片\",\r\n\t\t\t\tvalue: 1,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tlabel: \"编辑图片\",\r\n\t\t\t\tvalue: 2,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tlabel: \"预览图片\",\r\n\t\t\t\tvalue: 3,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tlabel: \"删除图片\",\r\n\t\t\t\tvalue: 4,\r\n\t\t\t}\r\n\t\t]\r\n\t]);\r\n\r\n\tonPullDownRefresh(() => {\r\n\t\tconsole.log(\"下拉刷新\");\r\n\t});\r\n\r\n\tonShow(() => {});\r\n\r\n\t// 编辑图片\r\n\tconst editPicture = (item, index) => {\r\n\t\tediteImage.value = true\r\n\t\tseletIndex.value = index\r\n\t\tcropImage.value = fileListBackups.value[index].url;\r\n\t}\r\n\r\n\t// \r\n\tconst editImagePicker = (item) => {\r\n\t\tediteImage.value = false\r\n\t\tif (item.value[0].value == 1) {\r\n\t\t\tuni.chooseImage({\r\n\t\t\t\tcount: 1, //默认9\r\n\t\t\t\tsizeType: [\"original\"], //可以指定是原图还是压缩图，默认二者都有\r\n\t\t\t\tsourceType: [\"album\"], //从相册选择\r\n\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\tcropImage.value = res.tempFilePaths[0];\r\n\t\t\t\t\tisOpenCropper.value = true;\r\n\t\t\t\t\tfileListBackups.value[seletIndex.value] = {\r\n\t\t\t\t\t\t...fileListBackups.value[seletIndex.value],\r\n\t\t\t\t\t\turl: res.tempFilePaths[0],\r\n\t\t\t\t\t\tstatus: \"success\",\r\n\t\t\t\t\t\tmessage: `${seletIndex.value}`,\r\n\t\t\t\t\t};\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (item.value[0].value == 2) {\r\n\t\t\tcropImage.value = fileListBackups.value[seletIndex.value]\r\n\t\t\tisOpenCropper.value = true;\r\n\t\t}\r\n\r\n\t\tif (item.value[0].value == 3) {\r\n\t\t\tuni.previewImage({\r\n\t\t\t\turls: fileList.value.map((val) => val.url),\r\n\t\t\t\tcurrent: seletIndex.value,\r\n\t\t\t\tlongPressActions: {\r\n\t\t\t\t\titemList: [\"发送给朋友\", \"保存图片\", \"收藏\"],\r\n\t\t\t\t\tsuccess: function(data) {\r\n\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\"选中了第\" +\r\n\t\t\t\t\t\t\t(data.tapIndex + 1) +\r\n\t\t\t\t\t\t\t\"个按钮,第\" +\r\n\t\t\t\t\t\t\t(data.index + 1) +\r\n\t\t\t\t\t\t\t\"张图片\"\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: function(err) {\r\n\t\t\t\t\t\tconsole.log(err.errMsg);\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (item.value[0].value == 4) {\r\n\t\t\tfileList.value[seletIndex.value] = {\r\n\t\t\t\t...fileList.value[seletIndex.value],\r\n\t\t\t\turl: \"\",\r\n\t\t\t\tstatus: \"success\",\r\n\t\t\t\tmessage: `${seletIndex.value}`,\r\n\t\t\t};\r\n\t\t\tfileListBackups.value[seletIndex.value] = {\r\n\t\t\t\t...fileListBackups.value[seletIndex.value],\r\n\t\t\t\turl: \"\",\r\n\t\t\t\tstatus: \"success\",\r\n\t\t\t\tmessage: `${seletIndex.value}`,\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\t// 裁切图片\r\n\tconst handleCrop = (url) => {\r\n\t\tisOpenCropper.value = false;\r\n\t\tfileList.value[seletIndex.value] = {\r\n\t\t\t...fileList.value[seletIndex.value],\r\n\t\t\turl: url,\r\n\t\t\tstatus: \"success\",\r\n\t\t\tmessage: `${seletIndex.value}`,\r\n\t\t};\r\n\t};\r\n\r\n\t// 绘制图片\r\n\tconst drawItem = (ctx, item) => {\r\n\t\tif (item.url) {\r\n\t\t\t// ctx.drawImage(图片对象, 图像裁剪的x位置, 图像裁剪的y位置, 裁剪的宽度, 裁剪的高度, x位置, y位置, 宽度, 高度)\r\n\t\t\tctx.drawImage(item.url, item.x, item.y, item.width, item.height);\r\n\t\t} else {\r\n\t\t\t// 没有图片绘制白色背景\r\n\t\t\tctx.setFillStyle(\"white\");\r\n\t\t\tctx.fillRect(item.x, item.y, item.width, item.height);\r\n\t\t}\r\n\t};\r\n\r\n\t// 生成图片\r\n\tconst getCanvasSize = async () => {\r\n\t\tconst width = previewMain.value.width\r\n\t\tconst height = previewMain.value.height\r\n\t\t// 创建canvas\r\n\t\tconst ctx = uni.createCanvasContext(\"myCanvas\");\r\n\r\n\t\t// 设置背景颜色\r\n\t\tctx.setFillStyle(\"#e8e8e8\"); // 设置背景颜色为白色\r\n\t\tctx.fillRect(0, 0, width, height); // 填充整个画布\r\n\r\n\t\tlet ruse = JSON.parse(JSON.stringify(fileList.value))\r\n\t\t// 对 fileList 按 item.index 进行排序\r\n\t\truse.sort((a, b) => (a.zIndex || 1) - (b.zIndex || 1));\r\n\r\n\t\truse.forEach((item, index) => {\r\n\t\t\t// 根据index判断渲染的顺序\r\n\t\t\tdrawItem(ctx, item)\r\n\t\t});\r\n\r\n\t\t// 绘制完成后导出图片\r\n\t\tctx.draw(true, () => {\r\n\t\t\tuni.canvasToTempFilePath({\r\n\t\t\t\tcanvasId: \"myCanvas\",\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tconst tempFilePath = res.tempFilePath;\r\n\t\t\t\t\t// 预览生成的图片\r\n\t\t\t\t\tuni.previewImage({\r\n\t\t\t\t\t\tcurrent: tempFilePath, // 当前显示的图片链接\r\n\t\t\t\t\t\turls: [tempFilePath], // 需要预览的图片链接列表\r\n\t\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\t\tclearCanvas();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: () => {\r\n\t\t\t\t\t\t\tclearCanvas();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tconsole.error(\"合并图片失败:\", err);\r\n\t\t\t\t\t// 提示用户合并图片失败\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: \"合并图片失败\",\r\n\t\t\t\t\t\ticon: \"none\",\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\r\n\t// 清空画布\r\n\tconst clearCanvas = () => {\r\n\t\tconst ctx = uni.createCanvasContext(\"myCanvas\");\r\n\t\tctx.clearRect(0, 0, previewMain.value.width, previewMain.value.height); // 清空整个画布\r\n\t\tctx.draw();\r\n\t};\r\n\r\n\t// 批量录入\r\n\tconst batchInput = () => {\r\n\t\tconst count = fileListBackups.value.length;\r\n\t\tuni.chooseImage({\r\n\t\t\tcount, // 数量控制\r\n\t\t\tsizeType: [\"original\"], // 可以指定是原图还是压缩图，默认二者都有\r\n\t\t\tsourceType: [\"album\"], // 从相册选择\r\n\t\t\tsuccess: async function(res) {\r\n\t\t\t\tfor (let index = 0; index < res.tempFilePaths.length; index++) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tconst ctx = uni.createCanvasContext(\"myCanvas\");\r\n\t\t\t\t\t\tconst { width, height } = fileList.value[index]; // 容器大小\r\n\t\t\t\t\t\tconst proportion = width / height; // 容器宽高比\r\n\r\n\t\t\t\t\t\t// 保存原始数据\r\n\t\t\t\t\t\tfileListBackups.value[index] = {\r\n\t\t\t\t\t\t\t...fileListBackups.value[index],\r\n\t\t\t\t\t\t\turl: res.tempFilePaths[index], // 原图\r\n\t\t\t\t\t\t\tstatus: \"success\",\r\n\t\t\t\t\t\t\tmessage: `${index}`,\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t// 获取图片宽高做裁切\r\n\t\t\t\t\t\tconst imageInfo = await getImageInfo(res.tempFilePaths[index]);\r\n\r\n\t\t\t\t\t\t// 计算宽高比例最大限度不变形适配\r\n\t\t\t\t\t\tlet imageW = imageInfo.width;\r\n\t\t\t\t\t\tlet imageH = imageInfo.height;\r\n\t\t\t\t\t\tlet drawX = 0;\r\n\t\t\t\t\t\tlet drawY = 0;\r\n\r\n\t\t\t\t\t\t// 计算绘制位置\r\n\t\t\t\t\t\tif (imageW / imageH > proportion) {\r\n\t\t\t\t\t\t\t\timageW = imageH * proportion;\r\n\t\t\t\t\t\t\t\tdrawX = (imageInfo.width - imageW) / 2;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\timageH = imageW / proportion;\r\n\t\t\t\t\t\t\t\tdrawY = (imageInfo.height - imageH) / 2;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// 禁用图像平滑处理以保持清晰度\r\n\t\t\t\t\t\tctx.imageSmoothingEnabled = false;\r\n\r\n\t\t\t\t\t\t// 绘制图片\r\n\t\t\t\t\t\tawait ctx.drawImage(res.tempFilePaths[index], drawX, drawY, imageW, imageH, 0, 0,\r\n\t\t\t\t\t\t\tpreviewMain.value.width, previewMain.value.height);\r\n\r\n\t\t\t\t\t\t// 绘制完成后导出图片\r\n\t\t\t\t\t\tawait ctx.draw(true);\r\n\t\t\t\t\t\tconst cropImage = (await uni.canvasToTempFilePath({\r\n\t\t\t\t\t\t\tcanvasId: \"myCanvas\"\r\n\t\t\t\t\t\t})).tempFilePath;\r\n\t\t\t\t\t\tawait ctx.clearRect(0, 0, previewMain.value.width, previewMain.value\r\n\t\t\t\t\t\t.height); // 清空整个画布\r\n\t\t\t\t\t\tawait ctx.draw(); // 清除\r\n\r\n\t\t\t\t\t\tconsole.log('cropImage', cropImage);\r\n\r\n\t\t\t\t\t\t// 预览生成的图片\r\n\t\t\t\t\t\tfileList.value[index] = {\r\n\t\t\t\t\t\t\t...fileList.value[index],\r\n\t\t\t\t\t\t\turl: cropImage,\r\n\t\t\t\t\t\t\tstatus: \"success\",\r\n\t\t\t\t\t\t\tmessage: `${index}`,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\tconsole.error(\"处理图片失败: \", error);\r\n\t\t\t\t\t\tfileListBackups.value[index] = {\r\n\t\t\t\t\t\t\t...fileListBackups.value[index],\r\n\t\t\t\t\t\t\tstatus: \"error\",\r\n\t\t\t\t\t\t\tmessage: error.message,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfail: function(error) {\r\n\t\t\t\tconsole.error(\"选择图片失败: \", error);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tconst getImageInfo = (src) => {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tuni.getImageInfo({\r\n\t\t\t\tsrc,\r\n\t\t\t\tsuccess: resolve,\r\n\t\t\t\tfail: reject\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\r\n\t// 选择图片类型\r\n\tconst typeConfirm = (item) => {\r\n\t\titem = item.value[0]\r\n\t\tformData.imageType = item.value;\r\n\t\tformData.imageTypeText = item.label;\r\n\t\tshowImageType.value = false;\r\n\t\tformData.scale = 1;\r\n\r\n\t\tconst typeFunctions = {\r\n\t\t\t1: nineSquareGrid,\r\n\t\t\t2: nineSquareGrid,\r\n\t\t\t3: lrSymmetry,\r\n\t\t\t4: tbSymmetry,\r\n\t\t\t5: l3r2,\r\n\t\t\t6: l2r3,\r\n\t\t};\r\n\r\n\t\tconst selectedFunction = typeFunctions[formData.imageType];\r\n\t\tif (selectedFunction) {\r\n\t\t\tselectedFunction();\r\n\t\t}\r\n\t};\r\n\r\n\t// 中心放大\r\n\tconst formDataScale = (e) => {\r\n\t\tformData.scale = e;\r\n\t\tlet result = {\r\n\t\t\tx: fileList.value[3].x + fileList.value[3].width + spacing.value,\r\n\t\t\ty: fileList.value[3].y + fileList.value[3].height + spacing.value,\r\n\t\t\twidth: 0,\r\n\t\t\theight: 0,\r\n\t\t};\r\n\r\n\t\tconst originalWidth = fileList.value[3].width\r\n\t\tconst originalHeight = fileList.value[3].height\r\n\r\n\t\t// 计算放大比例\r\n\t\tconst scaleRatio = e / 100 + 1;\r\n\r\n\t\t// 调整宽度和高度\r\n\t\tresult.width = originalWidth * scaleRatio;\r\n\t\tresult.height = originalHeight * scaleRatio;\r\n\r\n\t\t// 计算新的 x 和 y 坐标，保持中心点不变\r\n\t\tconst originalX = result.x - (result.width - originalWidth) / 2;\r\n\t\tconst originalY = result.y - (result.height - originalHeight) / 2;\r\n\r\n\t\tresult.x = originalX;\r\n\t\tresult.y = originalY;\r\n\r\n\t\tfileList.value[4] = {\r\n\t\t\t...fileList.value[4],\r\n\t\t\tx: result.x,\r\n\t\t\ty: result.x,\r\n\t\t\twidth: result.width,\r\n\t\t\theight: result.height,\r\n\t\t\tzIndex: 700\r\n\t\t};\r\n\t}\r\n\t// 间距调节\r\n\tconst spacingSize = (e) => {\r\n\t\tspacing.value = e\r\n\t\t\r\n\t\tconst typeFunctions = {\r\n\t\t\t1: nineSquareGrid,\r\n\t\t\t3: lrSymmetry,\r\n\t\t\t4: tbSymmetry,\r\n\t\t\t5: l3r2,\r\n\t\t\t6: l2r3,\r\n\t\t};\r\n\t\t\r\n\t\tconst selectedFunction = typeFunctions[formData.imageType];\r\n\t\tif (selectedFunction) {\r\n\t\t\tselectedFunction();\r\n\t\t}\r\n\t}\r\n\t// 图片缩放到容器合适大小\r\n\tconst imageAdaptation = async (container,image) => {\r\n\t\tconst { width, height } = container // 容器大小\r\n\t\tconst proportion = width / height; // 容器宽高比\r\n\t\tlet { imageW, imageH } = image // 图片大小\r\n\t\tlet drawX = 0;\r\n\t\tlet drawY = 0;\r\n\t\t\r\n\t\tif(image.width) {\r\n\t\t\timageW = image.width;\r\n\t\t\timageH = image.height;\r\n\t\t} else {\r\n\t\t\t// 获取图片宽高做裁切\r\n\t\t\tconst imageInfo = await getImageInfo(image);\r\n\t\t\t// 计算宽高比例最大限度不变形适配\r\n\t\t\timageW = imageInfo.width;\r\n\t\t\timageH = imageInfo.height;\r\n\t\t}\r\n\t\t\r\n\t\t// 计算绘制位置\r\n\t\tif (imageW / imageH > proportion) {\r\n\t\t\t\timageW = imageH * proportion;\r\n\t\t\t\tdrawX = (imageInfo.width - imageW) / 2;\r\n\t\t} else {\r\n\t\t\t\timageH = imageW / proportion;\r\n\t\t\t\tdrawY = (imageInfo.height - imageH) / 2;\r\n\t\t}\r\n\t}\r\n\t// 图片裁切\r\n\tconst imageCropping = () => {\r\n\t\tuni.chooseImage({\r\n\t\t\tcount: 1, //默认9\r\n\t\t\tsizeType: [\"original\"], //可以指定是原图还是压缩图，默认二者都有\r\n\t\t\tsourceType: [\"album\"], //从相册选择\r\n\t\t\tsuccess: async function(res) {\r\n\t\t\t\tconst image = res.tempFilePaths[0];\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdebugger\r\n\t\t\t\t\tconst ctx = uni.createCanvasContext(\"myCanvas\");\r\n\t\t\t\t\tconst { width, height } = previewMain.value; // 容器大小\r\n\t\t\t\t\tconst proportion = width / height; // 容器宽高比\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 获取图片宽高做裁切\r\n\t\t\t\t\tconst imageInfo = await getImageInfo(image);\r\n\t\t\t\t\r\n\t\t\t\t\t// 计算宽高比例最大限度不变形适配\r\n\t\t\t\t\tlet imageW = imageInfo.width;\r\n\t\t\t\t\tlet imageH = imageInfo.height;\r\n\t\t\t\t\tlet drawX = 0;\r\n\t\t\t\t\tlet drawY = 0;\r\n\t\t\t\t\r\n\t\t\t\t\t// 计算绘制位置\r\n\t\t\t\t\tif (imageW / imageH > proportion) {\r\n\t\t\t\t\t\t\timageW = imageH * proportion;\r\n\t\t\t\t\t\t\tdrawX = (imageInfo.width - imageW) / 2;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\timageH = imageW / proportion;\r\n\t\t\t\t\t\t\tdrawY = (imageInfo.height - imageH) / 2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\t// 禁用图像平滑处理以保持清晰度\r\n\t\t\t\t\tctx.imageSmoothingEnabled = false;\r\n\t\t\t\t\r\n\t\t\t\t\t// 绘制图片\r\n\t\t\t\t\tawait ctx.drawImage(res.tempFilePaths[index], drawX, drawY, imageW, imageH, 0, 0,\r\n\t\t\t\t\t\tpreviewMain.value.width, previewMain.value.height);\r\n\t\t\t\t\r\n\t\t\t\t\t// 绘制完成后导出图片\r\n\t\t\t\t\tawait ctx.draw(true);\r\n\t\t\t\t\tconst cropImage = (await uni.canvasToTempFilePath({\r\n\t\t\t\t\t\tcanvasId: \"myCanvas\"\r\n\t\t\t\t\t})).tempFilePath;\r\n\t\t\t\t\tawait ctx.clearRect(0, 0, previewMain.value.width, previewMain.value\r\n\t\t\t\t\t.height); // 清空整个画布\r\n\t\t\t\t\tawait ctx.draw(); // 清除\r\n\t\t\t\t\r\n\t\t\t\t\tconsole.log('cropImage', cropImage);\r\n\t\t\t\t\r\n\t\t\t\t\t// 预览生成的图片\r\n\t\t\t\t\tfileList.value[index] = {\r\n\t\t\t\t\t\t...fileList.value[index],\r\n\t\t\t\t\t\turl: cropImage,\r\n\t\t\t\t\t\tstatus: \"success\",\r\n\t\t\t\t\t\tmessage: `${index}`,\r\n\t\t\t\t\t};\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error(\"处理图片失败: \", error);\r\n\t\t\t\t\tfileListBackups.value[index] = {\r\n\t\t\t\t\t\t...fileListBackups.value[index],\r\n\t\t\t\t\t\tstatus: \"error\",\r\n\t\t\t\t\t\tmessage: error.message,\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t});\r\n\t}\r\n\t\r\n</script>\r\n\r\n<template>\r\n\t<page title=\"拼图\" lButton=\"批量录入\" rButton=\"生成照片\" @lButton=\"batchInput\" @rButton=\"getCanvasSize\">\r\n\t\t<imageCropper v-show=\"isOpenCropper\" :cropImage=\"cropImage\" @handleCrop=\"handleCrop\"></imageCropper>\r\n\t\t<u-picker :show=\"showImageType\" :columns=\"columns\" keyName=\"label\" @cancel=\"showImageType = false\"\r\n\t\t\t@confirm=\"typeConfirm\" :closeOnClickOverlay='true'></u-picker>\r\n\t\t<u-picker :show=\"editeImage\" :columns=\"iamgeColumns\" keyName=\"label\" @cancel=\"editeImage = false\"\r\n\t\t\t@confirm=\"editImagePicker\" :closeOnClickOverlay='true'></u-picker>\r\n\t\t<view class=\"content\">\r\n\t\t\t<view class=\"content-main\">\r\n\t\t\t\t<view id=\"contentMain\" class=\"image-container\">\r\n\t\t\t\t\t<view class=\"image-view\" v-for=\"(item, index) of fileList\" :key=\"item.url || index\" :style=\"{\r\n\t\t\t\t\t  width: `${item.width}px`,\r\n\t\t\t\t\t  height: `${item.height}px`,\r\n\t\t\t\t\t  top: `${item.y}px`,\r\n\t\t\t\t\t  left: `${item.x}px`,\r\n\t\t\t\t\t\t'z-index': `${item.zIndex || 666}`\r\n\t\t\t\t\t}\" @click.stop=\"editPicture(item, index)\">\r\n\t\t\t\t\t\t<u-image :height=\"`${item.height}px`\" :width=\"`${item.width}px`\" mode=\"aspectFill\"\r\n\t\t\t\t\t\t\t:src=\"item.url\">\r\n\t\t\t\t\t\t</u-image>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<view class=\"preview-main-bottom\">\r\n\t\t\t\t\t<canvas canvas-id=\"myCanvas\"\r\n\t\t\t\t\t\t:style=\"{ width: previewMain.width +'px', height: previewMain.height +'px', opacity: 0, zIndex: 1 }\"></canvas>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"controlPanel\">\r\n\t\t\t\t<!-- <u-collapse\r\n\t\t\t\t\t@change=\"change\"\r\n\t\t\t\t\t@close=\"close\"\r\n\t\t\t\t\t@open=\"open\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<u-collapse-item\r\n\t\t\t\t\t  title=\"选择拼图类型\"\r\n\t\t\t\t\t  name=\"Docs guide\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t <view class=\"puzzleType\">\r\n\t\t\t\t\t\t <view @click=\"typeConfirm(item)\" class=\"puzzleType-list\" v-for=\"(item, index) of columns[0]\" :key=\"item.label || index\">\r\n\t\t\t\t\t\t\t  <u-image height=\"70px\" width=\"70px\" :src=\"item.url\" mode=\"\"></u-image>\r\n\t\t\t\t\t\t\t{{item.label}}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t </view>\r\n\t\t\t\t\t</u-collapse-item>\r\n\t\t\t\t</u-collapse> -->\r\n\t\t\r\n\t\t\t\t<u-form labelWidth=\"100px\" labelPosition=\"left\" labelAlign=\"left\" :model=\"formData\" ref=\"form1\">\r\n\t\t\t\t\t<u-form-item label=\"选择拼图类型\" prop=\"imageType\" borderBottom ref=\"imageType\" border=\"none\"\r\n\t\t\t\t\t\tplaceholder=\"请选择\" @click=\"showImageType = true\">\r\n\t\t\t\t\t\t<u-input v-model=\"formData.imageTypeText\" disabled disabledColor=\"#ffffff\" placeholder=\"请选择\"\r\n\t\t\t\t\t\t\tborder=\"none\"></u-input>\r\n\t\t\t\t\t\t<template #right>\r\n\t\t\t\t\t\t\t<u-icon name=\"arrow-right\"></u-icon>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</u-form-item>\r\n\t\t\t\t\t<u-form-item label=\"间距\" prop=\"opacity\" borderBottom ref=\"text\">\r\n\t\t\t\t\t\t<view style=\"display: flex; align-items: center\">\r\n\t\t\t\t\t\t\t<view style=\"width: 83%\">\r\n\t\t\t\t\t\t\t\t<u-slider v-model=\"spacing\" @changing=\"spacingSize\" min=\"0\"\r\n\t\t\t\t\t\t\t\t\tmax=\"10\"></u-slider>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t{{ `${spacing} %` }}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</u-form-item>\r\n\t\t\t\t\t<u-form-item v-if=\"formData.imageType == 2\" label=\"中间图片大小\" prop=\"opacity\" borderBottom ref=\"text\">\r\n\t\t\t\t\t\t<view style=\"display: flex; align-items: center\">\r\n\t\t\t\t\t\t\t<view style=\"width: 83%\">\r\n\t\t\t\t\t\t\t\t<u-slider v-model=\"formData.scale\" @changing=\"formDataScale\" min=\"1\"\r\n\t\t\t\t\t\t\t\t\tmax=\"100\"></u-slider>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t{{ `${formData.scale} %` }}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</u-form-item>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!-- <u-form-item label=\"图片裁切\" prop=\"opacity\" borderBottom ref=\"text\">\r\n\t\t\t\t\t\t<view style=\"display: flex; align-items: center\">\r\n\t\t\t\t\t\t\t<view style=\"width: 83%\">\r\n\t\t\t\t\t\t\t\t<u-image height=\"30px\" width=\"30px\" mode=\"aspectFill\"\r\n\t\t\t\t\t\t\t\t\t:src=\"formData.image\" @click=\"imageCropping\">\r\n\t\t\t\t\t\t\t\t</u-image>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</u-form-item> -->\r\n\t\t\t\t</u-form>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</page>\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n\t.content {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tpadding: 10px;\r\n\t\theight: calc(100vh - 20px);\r\n\t\tbackground: #e8e8e8;\r\n\t\toverflow-y: hidden;\r\n\t\t\r\n\t\t.content-main {\r\n\t\t\tposition: relative;\r\n\t\t\twidth: calc(100vw - 20px);\r\n\t\t\theight: calc(100vw - 20px);\r\n\t\t\tborder-radius: 6px;\r\n\t\t\tbackground: #ffffff;\r\n\t\t\t// overflow: auto;\r\n\r\n\t\t\t.preview-main-top {\r\n\t\t\t\tpointer-events: none;\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\ttop: 0px;\r\n\t\t\t\tpadding: 10px;\r\n\t\t\t\twidth: calc(100vw - 40px);\r\n\t\t\t\theight: calc(100vw - 40px);\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgrid-gap: 5px;\r\n\t\t\t\tgrid-template-rows: 1fr 1fr 1fr;\r\n\t\t\t\tgrid-template-columns: 1fr 1fr 1fr;\r\n\t\t\t\tz-index: 300;\r\n\r\n\t\t\t\t.preview-main-image {\r\n\t\t\t\t\tpadding: 5px;\r\n\t\t\t\t\twidth: calc(100% - 10px);\r\n\t\t\t\t\theight: calc(100% - 10px);\r\n\t\t\t\t\tposition: relative;\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\tjustify-content: space-between;\r\n\r\n\t\t\t\t\t.preview-main-image-icon {\r\n\t\t\t\t\t\tpointer-events: auto;\r\n\t\t\t\t\t\twidth: 16px;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.preview-main-bottom {\r\n\t\t\t\tz-index: 100;\r\n\t\t\t\tpointer-events: none;\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\ttop: 0px;\r\n\t\t\t\twidth: calc(100vw - 20px);\r\n\t\t\t\theight: calc(100vw - 20px);\r\n\t\t\t\tdisplay: node;\r\n\t\t\t\tpadding: 10px;\r\n\t\t\t}\r\n\r\n\t\t\t.preview-main {\r\n\t\t\t\tpadding: 10px;\r\n\t\t\t\twidth: calc(100vw - 40px);\r\n\t\t\t\theight: calc(100vw - 40px);\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgrid-gap: 5px;\r\n\t\t\t\tz-index: 200;\r\n\t\t\t\tgrid-template-rows: 1fr 1fr 1fr;\r\n\t\t\t\tgrid-template-columns: 1fr 1fr 1fr;\r\n\t\t\t}\r\n\r\n\t\t\t.preview-main-lr {\r\n\t\t\t\tpadding: 10px;\r\n\t\t\t\twidth: calc(100vw - 40px);\r\n\t\t\t\theight: calc(100vw - 40px);\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgrid-gap: 5px;\r\n\t\t\t\tz-index: 200;\r\n\t\t\t\tgrid-template-columns: 1fr 1fr;\r\n\t\t\t}\r\n\r\n\t\t\t.preview-main-tb {\r\n\t\t\t\tpadding: 10px;\r\n\t\t\t\twidth: calc(100vw - 40px);\r\n\t\t\t\theight: calc(100vw - 40px);\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgrid-gap: 5px;\r\n\t\t\t\tz-index: 200;\r\n\t\t\t\tgrid-template-rows: 1fr 1fr;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.controlPanel {\r\n\t\t\tmargin-top: 10px;\r\n\t\t\twidth: calc(100vw - 40px);\r\n\t\t\tpadding: 10px;\r\n\t\t\t// overflow-y: auto;\r\n\t\t\tborder-radius: 6px;\r\n\t\t\tbackground: #ffffff;\r\n\t\t\toverflow-y: auto;\r\n\t\t\t.puzzleType {\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgrid-template-columns: 1fr 1fr;\r\n\t\t\t\tgap: 10px;\r\n\t\t\t\t.puzzleType-list {\r\n\t\t\t\t\theight: 100px;\r\n\t\t\t\t\tbackground: #f3f4f6;\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\tgap: 10px;\r\n\t\t\t\t\tflex-direction: row;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tjustify-content: center;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.image-container {\r\n\t\twidth: calc(100vw - 40px);\r\n\t\theight: calc(100vw - 40px);\r\n\t\tmargin: 10px;\r\n\t\tbackground-color: #e8e8e8;\r\n\t\tposition: relative;\r\n\r\n\t\t.image-view {\r\n\t\t\tbackground-color: #f3f3f3;\r\n\t\t\tposition: absolute;\r\n\r\n\t\t\t.iamge-icon {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\ttop: 0;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: space-between;\r\n\t\t\t\tpointer-events: auto;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t.u-cell__body {\r\n\t\tpadding: 10px 0 !important;\r\n\t}\r\n</style>\r\n","import MiniProgramPage from '/Users/pq/code/ph/pages/home/ph/jigsawPuzzle/jigsawPuzzle.vue'\nwx.createPage(MiniProgramPage)"],"names":["getCurrentInstance","ref","reactive","onLoad","nextTick","onMounted","uni","onPullDownRefresh","onShow","cropImage"],"mappings":"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"}