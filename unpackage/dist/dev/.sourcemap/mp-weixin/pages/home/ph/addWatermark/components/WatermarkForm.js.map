{"version":3,"file":"WatermarkForm.js","sources":["pages/home/ph/addWatermark/components/WatermarkForm.vue","/Users/pq/code/ph/pages/home/ph/addWatermark/components/WatermarkForm.vue?type=component"],"sourcesContent":["<template>\n  <view class=\"watermark-form\">\n    <u-form \n      ref=\"form1\"\n      labelWidth=\"100\" \n      labelPosition=\"left\" \n      labelAlign=\"left\"  \n      :model=\"modelValue\" \n      :disabled=\"disabled\"\n    >\n\n      <u-form-item \n        v-for=\"field in fields\"\n        :key=\"field.field\"\n        :label=\"field.label\"\n        :required=\"field.required\"\n      >\n       <!-- 定位输入框 -->\n        <template v-if=\"field.type === 'dinwei'\">\n        <u-input\n          v-model=\"modelValue[field.field]\"\n          :placeholder=\"field.placeholder\"\n          @input=\"onInputChange\"\n          :suffixIcon=\"field.suffixIcon\"\n          :suffixIconStyle=\"field.suffixIconStyle\"\n           :customStyle=\"{zIndex: '0'}\"\n        >\n          <template #suffix>\n            <view style=\"color: #007AFF;\" @click.stop=\"getLocation\">\n              定位\n            </view>\n          </template>\n        </u-input>\n        </template>\n\n        <!-- 开关 -->\n        <template v-if=\"field.type === 'switch'\">\n          <u-switch v-model=\"modelValue[field.field]\" @change=\"onInputChange\"></u-switch>\n        </template>\n      \n        <!-- 滑块 -->\n        <template v-if=\"field.type === 'slider'\">\n          <view style=\"display: flex; align-items: center\">\n            <view style=\"width: 83%\">\n              <u-slider \n                v-model=\"modelValue[field.field]\" \n                :min=\"field.min\" \n                :max=\"field.max\"\n                :step=\"field.step || 1\"\n                activeColor=\"#007AFF\"\n                @changing=\"(e)=>spacingSize(e,field.field)\"\n              ></u-slider>\n            </view>\n            <view>\n              {{ `${modelValue[field.field] || 0}${field.unit}` }}\n            </view>\n          </view>\n        </template>\n\n        <!-- 输入框 -->\n        <template v-if=\"field.type === 'input'\">\n          <u-input \n            v-model=\"modelValue[field.field]\"\n            :placeholder=\"field.placeholder\"\n            @input=\"onInputChange\"\n            :customStyle=\"{zIndex: '0'}\"\n          />\n        </template>\n        \n        <!-- 时间选择器 -->\n        <template v-else-if=\"field.type === 'datetime'\">\n          <u-input \n            style=\"width: 100%;\"\n            v-model=\"modelValue[field.field]\"\n            :placeholder=\"field.placeholder\"\n            @focus=\"showPicker = true\"\n            :clearable=\"false\"\n            right-icon=\"calendar\"\n             :customStyle=\"{zIndex: '0'}\"\n          />\n          <u-datetime-picker\n            :show=\"showPicker\"\n            v-model=\"tempDate\"\n            mode=\"datetime\"\n            format=\"YYYY-MM-DD HH:mm:ss\"\n            :defaultValue=\"dayjs().valueOf()\"\n            @confirm=\"(value) => {\n              handleDateConfirm(value,field.field)\n            }\"\n            @cancel=\"showPicker = false\"\n            :closeOnClickOverlay=\"false\"\n          />\n        </template>\n        \n        <!-- 文本域 -->\n        <template v-else-if=\"field.type === 'textarea'\">\n          <u-textarea\n            v-model=\"modelValue[field.field]\"\n            :placeholder=\"field.placeholder\"\n            :maxlength=\"field.maxlength\"\n            @input=\"onInputChange\"\n          />\n        </template>\n\n         <!-- 按钮 -->\n         <template v-if=\"field.type === 'button'\">\n          <u-button\n            :placeholder=\"field.placeholder\"\n            @click=\"onInputChange\"\n          />\n        </template>\n      </u-form-item>\n    </u-form>\n\n    <MapDisplay\n      v-if=\"showMap\"\n      :latitude=\"latitude\"\n      :longitude=\"longitude\"\n      :markers=\"covers\"\n      @closeMap=\"closeMap\"\n    />\n  </view>\n</template>\n\n<script setup>\nimport { ref, watch } from 'vue';\nimport dayjs from 'dayjs'\nimport MapDisplay from './MapDisplay.vue'\n\nconst props = defineProps({\n  modelValue: {\n    type: Object,\n    required: true\n  },\n  fields: {\n    type: Array,\n    default: () => []\n  },\n  disabled: {\n    type: Boolean,\n    default: false\n  }\n})\nconsole.log('props=====', props)\n\nconst showMap = ref(false)\nconst emit = defineEmits(['dataChanged', 'update:modelValue']); // 添加缺失的事件声明\n\nconst showPicker = ref(false)\nconst tempDate = ref(dayjs().valueOf())\n\n// 保留 covers 的定义（如果需要在父组件操作标记点）\nconst covers = ref([{\n  latitude: 39.90923,\n  longitude: 116.397428,\n  title: '当前位置'\n}])\n\nconst handleDateConfirm = (value, field) => {\n  const formattedDate = dayjs(value.value).format('YYYY-MM-DD HH:mm:ss');\n  const newModelValue = { \n    ...props.modelValue, \n    [field] : formattedDate \n  };\n  tempDate.value = formattedDate\n  emit('update:modelValue', newModelValue);\n  showPicker.value = false;\n};\n\nconst onInputChange = () => {\n  console.log('modelValue',props.modelValue)\n  emit('update:modelValue', props.modelValue);\n};\n\nconst closeMap = (item) => {\n  showMap.value = false\n  emit('update:modelValue',{\n    ...props.modelValue,\n    longitude : Number(item.longitude).toFixed(6),\n    latitude : Number(item.latitude).toFixed(6),\n    address : item.address\n  });\n}\n\nconst spacingSize = (value,field) => {\n  emit('update:modelValue',{\n    ...props.modelValue,\n    [field] : value\n  });\n}\n\n// 获取经纬度\nconst getLocation = () => {\n  uni.chooseLocation({\n    success: (res) => {\n      console.log('chooseLocation', res)\n       emit('update:modelValue',{\n        ...props.modelValue,\n        longitude : Number(res.longitude).toFixed(6),\n        latitude : Number(res.latitude).toFixed(6),\n        address : res.address\n      });\n    }\n  })\n}\n</script>\n\n<style lang=\"less\" scoped>\n.watermark-form {\n  background: #ffffff;\n  border-radius: 8px;\n  padding: 15px;\n}\n.u-form-item__body__right__content__slot {\n  .u-popup {\n    flex: 0;\n  }\n}\n\n.slider-value {\n  text-align: right;\n  color: #666;\n  font-size: 14px;\n  margin-top: 8px;\n}\n\n</style> \n","import Component from '/Users/pq/code/ph/pages/home/ph/addWatermark/components/WatermarkForm.vue'\nwx.createComponent(Component)"],"names":["uni","ref","dayjs"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AA+HA,MAAM,aAAa,MAAW;;;;;;;;;;;;;;;;;;;AAE9B,UAAM,QAAQ;AAcdA,kBAAA,MAAA,MAAA,OAAA,kEAAY,cAAc,KAAK;AAE/B,UAAM,UAAUC,cAAG,IAAC,KAAK;AACzB,UAAM,OAAO;AAEb,UAAM,aAAaA,cAAG,IAAC,KAAK;AAC5B,UAAM,WAAWA,cAAG,IAACC,oBAAO,EAAC,QAAO,CAAE;AAGtC,UAAM,SAASD,cAAG,IAAC,CAAC;AAAA,MAClB,UAAU;AAAA,MACV,WAAW;AAAA,MACX,OAAO;AAAA,IACT,CAAC,CAAC;AAEF,UAAM,oBAAoB,CAAC,OAAO,UAAU;AAC1C,YAAM,gBAAgBC,cAAAA,MAAM,MAAM,KAAK,EAAE,OAAO,qBAAqB;AACrE,YAAM,gBAAgB;AAAA,QACpB,GAAG,MAAM;AAAA,QACT,CAAC,KAAK,GAAI;AAAA,MACd;AACE,eAAS,QAAQ;AACjB,WAAK,qBAAqB,aAAa;AACvC,iBAAW,QAAQ;AAAA,IACrB;AAEA,UAAM,gBAAgB,MAAM;AAC1BF,oBAAA,MAAA,MAAA,OAAA,kEAAY,cAAa,MAAM,UAAU;AACzC,WAAK,qBAAqB,MAAM,UAAU;AAAA,IAC5C;AAEA,UAAM,WAAW,CAAC,SAAS;AACzB,cAAQ,QAAQ;AAChB,WAAK,qBAAoB;AAAA,QACvB,GAAG,MAAM;AAAA,QACT,WAAY,OAAO,KAAK,SAAS,EAAE,QAAQ,CAAC;AAAA,QAC5C,UAAW,OAAO,KAAK,QAAQ,EAAE,QAAQ,CAAC;AAAA,QAC1C,SAAU,KAAK;AAAA,MACnB,CAAG;AAAA,IACH;AAEA,UAAM,cAAc,CAAC,OAAM,UAAU;AACnC,WAAK,qBAAoB;AAAA,QACvB,GAAG,MAAM;AAAA,QACT,CAAC,KAAK,GAAI;AAAA,MACd,CAAG;AAAA,IACH;AAGA,UAAM,cAAc,MAAM;AACxBA,oBAAAA,MAAI,eAAe;AAAA,QACjB,SAAS,CAAC,QAAQ;AAChBA,wBAAAA,MAAY,MAAA,OAAA,kEAAA,kBAAkB,GAAG;AAChC,eAAK,qBAAoB;AAAA,YACxB,GAAG,MAAM;AAAA,YACT,WAAY,OAAO,IAAI,SAAS,EAAE,QAAQ,CAAC;AAAA,YAC3C,UAAW,OAAO,IAAI,QAAQ,EAAE,QAAQ,CAAC;AAAA,YACzC,SAAU,IAAI;AAAA,UACtB,CAAO;AAAA,QACF;AAAA,MACL,CAAG;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3MA,GAAG,gBAAgB,SAAS;"}